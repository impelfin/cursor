# 프로젝트 개요: 엑셀 파일 우편번호 자동 채우기 웹 서비스

## 1. 프로젝트 목표

사용자가 업로드한 엑셀 파일 내 'Data' 시트의 주소 정보를 기반으로 우편번호를 검색하여 비어있는 우편번호 셀을 자동으로 채우고, 완성된 파일을 다시 사용자에게 제공하는 웹 서비스를 구축하는 것을 목표로 합니다. **특히, 우편번호 검색은 공공데이터포털에서 제공하는 CSV 형태의 우편번호 데이터베이스를 활용하여 API 호출 없이 자체적으로 처리합니다.**

## 2. 주요 기능

- **엑셀 파일 업로드**: 사용자로부터 `.xlsx` 또는 `.xls` 형식의 엑셀 파일을 웹 인터페이스를 통해 입력받습니다.
- **'Data' 시트 처리**: 업로드된 엑셀 파일에서 'Data'라는 이름의 시트를 식별하고 해당 시트의 데이터를 읽어옵니다.
- **주소 필드 추출**: 'Data' 시트의 4번째 열(주소 필드)에 있는 주소 정보를 추출합니다.
- **우편번호 검색 (CSV DB 활용)**: 추출된 주소 정보를 로컬에 구축된 우편번호 CSV DB에서 검색하여 해당 주소의 우편번호를 찾습니다.
  - (구현 시: 주소 문자열을 파싱하여 도로명, 건물 번호 등으로 분리 후 DB에서 매칭)
- **우편번호 채우기**: 검색된 우편번호를 'Data' 시트의 3번째 열(우편번호 필드)에 채워 넣습니다.
- **완성 파일 다운로드**: 우편번호가 모두 채워진 엑셀 파일을 사용자가 다운로드할 수 있도록 제공합니다.

## 3. 기술 스택

- **백엔드 언어**: Python
  - **웹 프레임워크**: Flask 또는 Django (간단한 웹 인터페이스 구현에 적합)
  - **엑셀 처리 라이브러리**: `openpyxl` (엑셀 파일 읽기/쓰기)
  - **데이터베이스**: SQLite, Pandas (CSV 파일을 메모리에 로드하거나 SQLite에 적재하여 사용)
  - **CSV 파싱/처리**: `pandas` (CSV 데이터 로드 및 처리)
- **프론트엔드 (웹 인터페이스)**:
  - HTML, CSS, JavaScript (파일 업로드 및 다운로드 인터페이스 구성)

## 4. 엑셀 파일 형식 (가정)

현재 엑셀 파일은 'Data' 시트에 다음과 같은 열 순서로 구성되어 있다고 가정합니다:

| 1번째 열 (번호) | 2번째 열 (이름) | 3번째 열 (우편번호) | 4번째 열 (주소) |
| :-------------: | :-------------: | :-----------------: | :-------------: |
|       값        |       값        |    **비어있음**     |       값        |

---

## 5. 우편번호 CSV 데이터 준비 (사전 작업)

이 프로젝트를 실행하기 전에 **가장 중요한 사전 작업**은 공공데이터포털에서 우편번호 CSV 파일을 다운로드하여 프로젝트가 접근할 수 있는 경로에 저장하는 것입니다.

**다운로드 방법:**

1.  **공공데이터포털 (data.go.kr)** 에 접속합니다.
2.  검색창에 "우편번호" 또는 "주소 DB"를 검색합니다.
3.  "파일데이터" 유형의 결과 중에서 **"과학기술정보통신부 우정사업본부\_우편번호"** 와 같이 전체 우편번호를 제공하는 데이터를 찾습니다. (파일명이나 설명에 '전국', '전체' 등의 키워드가 있는 것을 선택하세요.)
4.  해당 데이터 상세 페이지로 이동하여 **CSV 파일을 다운로드**합니다. (로그인 없이 다운로드가 가능한 경우가 많습니다.)
5.  다운로드 받은 CSV 파일을 프로젝트 폴더 내의 특정 위치 (예: `data/postcode.csv`)에 저장합니다.

---

### CSV DB를 활용하는 파이썬 코드 작성 시 고려사항

- **데이터 로딩**: Flask 앱이 시작될 때 CSV 파일을 메모리로 로드하거나, SQLite 같은 경량 DB에 적재하여 주소 검색에 사용할 수 있도록 준비해야 합니다. Pandas DataFrame으로 로드하는 것이 가장 일반적입니다.
- **주소 매칭 로직**: 입력된 주소(엑셀의 4번째 열)를 CSV DB에 있는 주소와 비교하여 매칭하는 로직을 작성해야 합니다. 단순히 문자열 일치만으로는 어려울 수 있으며, 부분 일치, 오타 허용 등을 고려한 고급 매칭 알고리즘이 필요할 수도 있습니다. (예: 주소를 시/도, 시/군/구, 도로명, 건물 번호 등으로 분리하여 여러 컬럼을 통해 검색)
- **성능 최적화**: 대용량 CSV 파일을 사용할 경우, 검색 속도 향상을 위해 인덱싱 등의 데이터베이스 최적화 기법을 고려해야 합니다.
